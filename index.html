<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QtDataSync: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" style="display: inline;">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QtDataSync
   &#160;<span id="projectnumber">4.2.0</span>
   </div>
   <div id="projectbrief">A simple offline-first synchronisation framework, to synchronize data of Qt applications between devices</div>
  </td>
 </tr>
 </tbody>
</table>
<a style="float: right;" target="_blank"  href="https://github.com/Skycoder42/QtDataSync">
<img style="padding: 10px;" src="GitHub_Logo.png"/>
</a>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">QtDataSync Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#qtdatasync_readme_label_0">Features</a></li>
<li class="level1"><a href="#qtdatasync_readme_label_1">Download/Installation</a></li>
<li class="level1"><a href="#qtdatasync_readme_label_2">Requirements</a><ul><li class="level2"><a href="#qtdatasync_readme_label_3">Docker</a></li>
</ul>
</li>
<li class="level1"><a href="#qtdatasync_readme_label_4">Usage</a><ul><li class="level2"><a href="#qtdatasync_readme_label_5">Basics</a></li>
<li class="level2"><a href="#qtdatasync_readme_label_6">Example</a><ul><li class="level3"><a href="#qtdatasync_readme_label_7">Initialize QtDataSync</a></li>
<li class="level3"><a href="#qtdatasync_readme_label_8">Using DataStore</a></li>
<li class="level3"><a href="#qtdatasync_readme_label_9">Setting up the remote server (qdsapp)</a></li>
<li class="level3"><a href="#qtdatasync_readme_label_10">Adding a second device to your account</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#qtdatasync_readme_label_11">Security</a></li>
<li class="level1"><a href="#qtdatasync_readme_label_12">Documentation</a></li>
<li class="level1"><a href="#qtdatasync_readme_label_13">References</a></li>
</ul>
</div>
<div class="textblock"><p>A simple offline-first synchronisation framework, to synchronize data of <a class="elRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qt.html">Qt</a> applications between devices.</p>
<p><a href="https://travis-ci.org/Skycoder42/QtDataSync"></a> <a href="https://ci.appveyor.com/project/Skycoder42/qtdatasync/branch/master"></a> <a href="https://hub.docker.com/r/skycoder42/qdsapp/"></a> <a href="https://www.codacy.com/app/Skycoder42/QtDataSync?utm_source=github.com&amp;amp;utm_medium=referral&amp;amp;utm_content=Skycoder42/QtDataSync&amp;amp;utm_campaign=Badge_Grade"></a> <a href="https://aur.archlinux.org/packages/qt5-datasync/"></a></p>
<div class="image">
<img src="demo.gif" alt="demo.gif"/>
<div class="caption">
Demo Animation</div></div>
 <h1><a class="anchor" id="qtdatasync_readme_label_0"></a>
Features</h1>
<ul>
<li>Document-Store like access, using QObjects and Q_GADGET classes<ul>
<li>Threadsafe synchronous access with global caching optimizations</li>
<li>Change signals on data modifications</li>
</ul>
</li>
<li>Cross platform library, works on linux, windows, macos, android and ios and can be used to synchronize data between any of these platforms</li>
<li><a class="elRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qt.html">Qt</a> "model" class (<code><a class="elRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtmvvm/qtmvvm.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/class_q_abstract_list_model.html">QAbstractListModel</a></code>) to view store data in item views</li>
<li>Permanent offline storage, to make shure apps work even without network</li>
<li>Remote synchronisation between devices<ul>
<li>Multi-user and multi-device system - data is synchronized per user on all his devices</li>
<li>Data is stored permanently on devices, and temporarily on the server</li>
<li>Data is end to end encrypted</li>
</ul>
</li>
<li>Private keys are stored in secure keystores<ul>
<li>Uses system keystore where possible. Currently supported:<ul>
<li>KWallet</li>
<li>Freedesktop Secret Service API (i.e. gnome-keyring)</li>
<li>macOs/iOs Keychain</li>
<li>Windows credentials store</li>
<li>Android Shared Preferences</li>
<li>(Unsecure) plain text keystore as fallback</li>
</ul>
</li>
<li>Custom keystores can be implemented via a plugin mechanism</li>
</ul>
</li>
<li>Includes a server application as a backend<ul>
<li>Can be used for multiple applications, independent of any data</li>
<li>Operates as "distribution" service (Does <em>not</em> permanently store data, only for transfering it to devices)</li>
<li>Operates with a PostgreSQL database</li>
<li>Includes a docker-compose file for the postgresql server</li>
<li>Is provided as docker image itself</li>
</ul>
</li>
<li>Controller classes to control and monitor the sync state and the account<ul>
<li>Can be used in any thread</li>
</ul>
</li>
<li>Class to exchange user identities between devices in a local network</li>
<li>Supports multi process mode (access and control data and engine from any process, with some restrictions)</li>
<li>Provides convenient QML bindings</li>
</ul>
<h1><a class="anchor" id="qtdatasync_readme_label_1"></a>
Download/Installation</h1>
<ol type="1">
<li><a class="elRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtqml/qtqml.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qml-package.html">Package</a> Managers: The library is available via:<ul>
<li><b>Arch-Linux:</b> AUR-Repository: <a href="https://aur.archlinux.org/packages/qt5-datasync/"><code>qt5-datasync</code></a></li>
<li><b>Ubuntu:</b> Launchpad-PPA: <a href="https://launchpad.net/~skycoder42/+archive/ubuntu/qt-modules">ppa:skycoder42/qt-modules</a>, package <code>libqt5datasync[4/-dev]</code></li>
<li><b>MacOs:</b><ul>
<li>Tap: <a href="https://github.com/Skycoder42/homebrew-qt-modules"><code>brew tap Skycoder42/qt-modules</code></a></li>
<li><a class="elRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtqml/qtqml.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qml-package.html">Package</a>: <code>qtdatasync</code></li>
<li><b>IMPORTANT:</b> Due to limitations of homebrew, you must run <code>source /usr/local/opt/qtdatasync/bashrc.sh</code> before you can use the module. Some goes for the <code>qtjsonserializer</code> dependency.</li>
</ul>
</li>
</ul>
</li>
<li>Simply add my repository to your <a class="elRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qt.html">Qt</a> MaintenanceTool (Image-based How-To here: <a href="https://github.com/Skycoder42/QtModules/blob/master/README.md#add-my-repositories-to-qt-maintenancetool">Add custom repository</a>):<ol type="a">
<li>Start the MaintenanceTool from the commandline using <code>/path/to/MaintenanceTool --addTempRepository &lt;url&gt;</code> with one of the following urls (GUI-Method is currently broken, see <a href="https://bugreports.qt.io/browse/QTIFW-1156">QTIFW-1156</a>) - This must be done <em>every time</em> you start the tool:<ul>
<li>On Linux: <a href="https://install.skycoder42.de/qtmodules/linux_x64">https://install.skycoder42.de/qtmodules/linux_x64</a></li>
<li>On Windows: <a href="https://install.skycoder42.de/qtmodules/windows_x86">https://install.skycoder42.de/qtmodules/windows_x86</a></li>
<li>On Mac: <a href="https://install.skycoder42.de/qtmodules/mac_x64">https://install.skycoder42.de/qtmodules/mac_x64</a></li>
</ul>
</li>
<li>A new entry appears under all supported <a class="elRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qt.html">Qt</a> Versions (e.g. <code><a class="elRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qt.html">Qt</a> &gt; <a class="elRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qt.html">Qt</a> 5.11 &gt; Skycoder42 <a class="elRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qt.html">Qt</a> modules</code>)</li>
<li>You can install either all of my modules, or select the one you need: <code><a class="elRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qt.html">Qt</a> Datasync</code></li>
<li>Continue the setup and thats it! you can now use the module for all of your installed Kits for that <a class="elRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qt.html">Qt</a></li>
</ol>
</li>
<li>Download the compiled modules from the release page. <b>Note:</b> You will have to add the correct ones yourself and may need to adjust some paths to fit your installation! In addition to that, you will have to download the modules this one depends on as well. See Section "Requirements" below.</li>
<li>Build it yourself! <b>Note:</b> This requires all build an runtime dependencies to be available (See Section "Requirements" below). If you don't have/need cmake, you can ignore the related warnings. To automatically build and install to your <a class="elRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qt.html">Qt</a> installation, run:<ul>
<li><code>qmake</code></li>
<li><code>make qmake_all</code></li>
<li><code>make</code> (If you want the tests/examples/etc. run <code>make all</code>)</li>
<li>Optional steps:<ul>
<li><code>make doxygen</code> to generate the documentation</li>
<li><code>make lrelease</code> to generate the translations</li>
</ul>
</li>
<li><code>make install</code></li>
</ul>
</li>
</ol>
<h1><a class="anchor" id="qtdatasync_readme_label_2"></a>
Requirements</h1>
<p>The library as a high level synchronisation backend has a few dependencies. They are listed below by categories. When installing via a package manager or with <a class="elRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qt.html">Qt</a> Maintenancetool (prefered methods, see section "Download/Installation"" above) all these dependencies will be installed automatically.</p>
<ul>
<li>Official <a class="elRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qt.html">Qt</a> Modules:<ul>
<li>QtCore (qtbase)</li>
<li>QtSql (qtbase) with the qsqlite plugin</li>
<li>QtWebSockets</li>
<li>QtScxml</li>
<li>QtRemoteObjects (currently a TP module)</li>
</ul>
</li>
<li>Custom <a class="elRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qt.html">Qt</a> modules:<ul>
<li><a href="https://github.com/Skycoder42/QtJsonSerializer">QtJsonSerializer</a></li>
<li><a href="https://github.com/Skycoder42/QtService">QtService</a> (For the qdsapp tool)</li>
</ul>
</li>
<li>Additional stuff for building it yourself:<ul>
<li>perl</li>
<li><a href="https://www.cryptopp.com/">CryptoPP library</a> (Can also be linked dynamically)</li>
<li><a href="https://github.com/Skycoder42/qpmx">qpmx</a></li>
<li><a href="https://github.com/Cutehacks/qpm">qpm</a></li>
<li>Some of the plugins also have additional dependencies:<ul>
<li>kwallet: <a href="https://api.kde.org/frameworks/kwallet/html/">KWallet Framework</a></li>
<li>secretservice: libsecret-1 via pkgconfig</li>
</ul>
</li>
<li>For the appserver:<ul>
<li>qpsql plugin for the QtSql module</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>To actually run the server, it needs to connect to a SQL Database. A little more specific: A PostgreSQL database. You can specify a different one, by setting a custom database driver in the configuration file, <b>but</b> the SQL used is PostgreSQL, so unless your DBS supports the same SQL flavor, you won't be able to get it running without modifications. You can host a PostgreSQL database using docker by running <code>docker-compose up -d</code> from <code>tools/qdatasyncserver</code>. This is further described in the example explaining how to set up the server.</p>
<h2><a class="anchor" id="qtdatasync_readme_label_3"></a>
Docker</h2>
<p>The <code>qdsapp</code> is also available as docker-image, <a href="https://hub.docker.com/r/skycoder42/qdsapp/"><code>skycoder42/qdsapp</code></a>. The versions are equal, i.e. <a class="el" href="namespace_qt_data_sync.html" title="The primary namespace of the QtDataSync library. ">QtDataSync</a> version 4.0.0 will work with the server Version 4.0.0 as well. The server is somewhat backwards compatible. This is checked on runtime for any client that connects.</p>
<h1><a class="anchor" id="qtdatasync_readme_label_4"></a>
Usage</h1>
<p>The datasync library is provided as a <a class="elRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qt.html">Qt</a> module. Thus, all you have to do is add the module, and then, in your project, add <code>QT += datasync</code> to your <code>.pro</code> file! Please note that when you deploy your application, you need both the library <em>and</em> the keystore plugins you intend to use.</p>
<h2><a class="anchor" id="qtdatasync_readme_label_5"></a>
Basics</h2>
<p>There are basically 3 kinds of classes typically used. This first one is the <code><a class="el" href="class_qt_data_sync_1_1_setup.html" title="The class to setup and create datasync instances. ">QtDataSync::Setup</a></code>. This one is used to configure a datasync instance and synchronize data to a server. It can also be used to start a passive instance, that does not actively synchronize and only allows access to the data.</p>
<p>The second group are the <code><a class="el" href="class_qt_data_sync_1_1_data_store.html" title="Main store to generically access all stored data synchronously. ">QtDataSync::DataStore</a>*</code> classes. They are used to access the data and perform CRUD operations on it. They only work with the locally stored data, but emit signals whenever data is changed (either by another datastore, or because it was synchronized). The <code><a class="el" href="class_qt_data_sync_1_1_data_store.html" title="Main store to generically access all stored data synchronously. ">QtDataSync::DataStore</a></code> is the basic class that allows you to generically access any data. The <code><a class="el" href="class_qt_data_sync_1_1_data_type_store.html" title="A wrapper around the DataStore limited to one type to make access simpler. ">QtDataSync::DataTypeStore</a></code> does the same, but is limited to one type. Finally, the <code><a class="el" href="class_qt_data_sync_1_1_caching_data_type_store.html" title="A DataTypeStore that caches all loaded data internally for faster access. ">QtDataSync::CachingDataTypeStore</a></code> extend this by initially loading all data of one type and keeping it in the memory. This can be more efficient if our frequently access the data.</p>
<p>The last group are the manager classes. The <code><a class="el" href="class_qt_data_sync_1_1_sync_manager.html" title="Manages the synchronization process and reports its state. ">QtDataSync::SyncManager</a></code> controlls the synchronisation and reports it's status, progress and any errors. The <code><a class="el" href="class_qt_data_sync_1_1_account_manager.html" title="Manages devices that belong to the users account. ">QtDataSync::AccountManager</a></code> is used to manage the devices data is shared with. They can be listed, added and removed. The <code><a class="el" href="class_qt_data_sync_1_1_user_exchange_manager.html" title="A helper class to exchange the account data between devices on the local network. ...">QtDataSync::UserExchangeManager</a></code> extends the AccountManager by making it possible to easily exchange the account data between devices in the same local network.</p>
<p>The examples below show how to use these different classes. For a full example of what can be done, checkout the <code>examples/datasync/Sample</code> example app.</p>
<h2><a class="anchor" id="qtdatasync_readme_label_6"></a>
Example</h2>
<p>The following examples descibe the different parts of the module, and how to use them. The following will explain how to:</p><ul>
<li>Create a setup and configure it.</li>
<li>Access the storage for read/write operations</li>
<li>Setup a server to synchronize with it</li>
<li>Add a second device to your account to synchronize data between them</li>
</ul>
<h3><a class="anchor" id="qtdatasync_readme_label_7"></a>
Initialize QtDataSync</h3>
<p>After adding datasync to your project, the next step is to setup datasync. In your main, you need to once create a setup. This <b>must</b> be done before you create any other datasync class, but after that, you can use it in your whole application from any thread. Multi-Process setups are possible, but more complicated. See documentation for more details.</p>
<p>To setup datasync, simply use the Setup class: </p><div class="fragment"><div class="line"><a class="code" href="class_qt_data_sync_1_1_setup.html">QtDataSync::Setup</a>()</div><div class="line">    .<a class="code" href="class_qt_data_sync_1_1_setup.html#a3e298d2dbc0add3f1670d91213a9a985">setRemoteConfiguration</a>(<a class="codeRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qurl.html">QUrl</a>(<span class="stringliteral">&quot;ws://localhost:4242&quot;</span>)) <span class="comment">//url to the server to connect to</span></div><div class="line">    <span class="comment">//do any additional setup, i.e. &quot;.setLocalDir(...)&quot; to specify a different local storage directory</span></div><div class="line">    .<a class="code" href="class_qt_data_sync_1_1_setup.html#a5ddf88aec2c428a6df10e039954ab26a">create</a>();</div></div><!-- fragment --><p>And thats it! On a second thread, the storage will be initialized. You can now use the different stores or the managers to access the data.</p>
<h3><a class="anchor" id="qtdatasync_readme_label_8"></a>
Using DataStore</h3>
<p>The data store allows you to access the store. The store can be used by defining datatypes that can be stored in there. The only limitation is that it must be either a class that extends <a class="elRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtautoupdater/qtautoupdater.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/class_q_object.html">QObject</a> or has the Q_GADGET macro. Only the Q_PROPERTY fields you define are stored. To identify a dataset the <code>USER</code> property is used and thus <b>must</b> be present. It's like the primary key. You can use any type you want, as long as it can be converted from and to <a class="elRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qstring.html">QString</a> via <a class="elRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qvariant.html">QVariant</a> (This means <code>QVariant::fromType(myData).toString()</code>, as well as <code><a class="elRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qvariant.html">QVariant(string)</a>.value&lt;MyData&gt;()</code> have to work as expected).</p>
<p>One example for such a storable datatype would be the following: </p><div class="fragment"><div class="line"><span class="keyword">struct </span>Data</div><div class="line">{</div><div class="line">    Q_GADGET</div><div class="line"></div><div class="line">    Q_PROPERTY(<span class="keywordtype">int</span> key MEMBER <span class="keywordtype">int</span> USER <span class="keyword">true</span>)</div><div class="line">    Q_PROPERTY(<a class="codeRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qstring.html">QString</a> value MEMBER value)</div><div class="line"></div><div class="line"><span class="keyword">public</span>:</div><div class="line">    Post();</div><div class="line"></div><div class="line">    <span class="keywordtype">int</span> key;</div><div class="line">    <a class="codeRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qstring.html">QString</a> value;</div><div class="line">};</div></div><!-- fragment --><p>This can now be stored and loaded using any of the DataStore classes. The code below will save on dataset, then load all that are stored: </p><div class="fragment"><div class="line"><span class="keyword">auto</span> store = <span class="keyword">new</span> <a class="code" href="class_qt_data_sync_1_1_data_store.html">QtDataSync::DataStore</a>(<span class="keyword">this</span>); <span class="comment">//Use the &quot;default setup&quot;</span></div><div class="line"></div><div class="line"><span class="comment">//store an entry</span></div><div class="line">store-&gt;save&lt;Data&gt;({42, <span class="stringliteral">&quot;tree&quot;</span>});</div><div class="line"><span class="comment">//load all entries</span></div><div class="line"><span class="keywordflow">for</span>(Data d : store-&gt;loadAll&lt;Data&gt;()) {</div><div class="line">    qDebug() &lt;&lt; d.key &lt;&lt; d.value;</div><div class="line">});</div></div><!-- fragment --><h3><a class="anchor" id="qtdatasync_readme_label_9"></a>
Setting up the remote server (qdsapp)</h3>
<p>In order to synchronize data, some server is needed. The quickest way for development is to use the prepared docker image in the sample projects folder. Just run <code>docker-compose up -d</code> to start it. It will create a postgres as well as a qdsapp instance to be used on port 4242. More details on how to configure the the server can be found in the documentation.</p>
<p>Once thats done, the library will automatically connect to the server and create an account, if the server was correctly configured with the setup. To synchronize changes, all you need to do now is to add a second device to your account.</p>
<h3><a class="anchor" id="qtdatasync_readme_label_10"></a>
Adding a second device to your account</h3>
<p>Adding a second devices is done via an exchange between those two devices. This is required to ensure no attacker can easily add himself to your account. The general idea is: You export the data from device A, then import it on device B. The part of getting the data from A to B must be done by your application, e.g. by storing it to a file or sending it over the local network. A must then accept B to be added to the account. It is also possible to secure the exported data with a password. In that case no confirmation is needed. Please note that device A must be connected to the remote for the whole login process. After device B was added, A will upload all it's local data to B. From that point on, any data changes on A or B are synchronized between the two.</p>
<p>The first partis to export the data from A. For this example, we use the password secured variant, as it is simpler. </p><div class="fragment"><div class="line"><span class="keyword">auto</span> manager = <span class="keyword">new</span> <a class="code" href="class_qt_data_sync_1_1_account_manager.html">QtDataSync::AccountManager</a>(<span class="keyword">this</span>); <span class="comment">//class used to access the account</span></div><div class="line">manager-&gt;exportAccountTrusted(<span class="keyword">true</span>, <span class="stringliteral">&quot;some_password&quot;</span>, [<span class="keyword">this</span>](<a class="codeRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qbytearray.html">QByteArray</a> data) {</div><div class="line">    saveToFile(data);<span class="comment">//somehow get the data to device B</span></div><div class="line">});</div></div><!-- fragment --><p>On device B, that exported data must be read and then imported: </p><div class="fragment"><div class="line"><span class="keyword">auto</span> manager = <span class="keyword">new</span> <a class="code" href="class_qt_data_sync_1_1_account_manager.html">QtDataSync::AccountManager</a>(<span class="keyword">this</span>); <span class="comment">//class used to access the account</span></div><div class="line"><span class="keyword">auto</span> data = loadFromFile();</div><div class="line">manager-&gt;importAccountTrusted(data, <span class="stringliteral">&quot;some_password&quot;</span>, [<span class="keyword">this</span>](<span class="keywordtype">bool</span> ok, <a class="codeRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qstring.html">QString</a> error) {</div><div class="line">    <span class="keywordflow">if</span>(ok)</div><div class="line">        qDebug() &lt;&lt; <span class="stringliteral">&quot;Import done!&quot;</span>;</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">        qDebug() &lt;&lt; <span class="stringliteral">&quot;Import failed with error:&quot;</span> &lt;&lt; error;</div><div class="line">});</div></div><!-- fragment --><p>If the import succeeded, the devices will automatically start synchronizing</p>
<h1><a class="anchor" id="qtdatasync_readme_label_11"></a>
Security</h1>
<p>The library uses end to end encryption and does not require a trusted server, as the server can neither read or write data, nor can he add a device to your account. Modern and secure crypto is used by making use of the <a href="https://www.cryptopp.com/">CryptoPP library</a> library. More details on the whole (security) protocol will follow in the future.</p>
<h1><a class="anchor" id="qtdatasync_readme_label_12"></a>
Documentation</h1>
<p>The documentation is available on <a href="https://skycoder42.github.io/QtDataSync/">github pages</a>. It was created using <a href="http://www.doxygen.org/">doxygen</a>. The HTML-documentation and Qt-Help files are shipped together with the module for both the custom repository and the package on the release page. Please note that doxygen docs do not perfectly integrate with QtCreator/QtAssistant.</p>
<h1><a class="anchor" id="qtdatasync_readme_label_13"></a>
References</h1>
<p>Many of the keystore implementations have been inspired by the awesome <a class="elRef" target="_blank" doxygen="/home/sky/Qt/Docs/Qt-5.11.2/qtcore/qtcore.tags:https://doc.qt.io/qt-5/" href="https://doc.qt.io/qt-5/qt.html">Qt</a> library <a href="https://github.com/frankosterfeld/qtkeychain">QtKeychain</a> by frankosterfeld. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Nov 17 2018 11:30:54 for QtDataSync by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
