<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>QtDataSync: README.md Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" style="display: inline;">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">QtDataSync
   &#160;<span id="projectnumber">4.0.1</span>
   </div>
   <div id="projectbrief">A simple offline-first synchronisation framework, to synchronize data of Qt applications between devices</div>
  </td>
 </tr>
 </tbody>
</table>
<a style="float: right;" target="_blank"  href="https://github.com/Skycoder42/QtDataSync">
<img style="padding: 10px;" src="GitHub_Logo.png"/>
</a>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">README.md</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;[TOC]</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;A simple offline-first synchronisation framework, to synchronize data of Qt applications between devices.</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;[![Travis Build Status](https://travis-ci.org/Skycoder42/QtDataSync.svg?branch=master)](https://travis-ci.org/Skycoder42/QtDataSync)</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;[![Appveyor Build status](https://ci.appveyor.com/api/projects/status/ygrlpdc6p3dcnmk1/branch/master?svg=true)](https://ci.appveyor.com/project/Skycoder42/qtdatasync/branch/master)</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;[![Codacy Badge](https://api.codacy.com/project/badge/Grade/3793032e97024b6ebec2f84ec2fd61ad)](https://www.codacy.com/app/Skycoder42/QtDataSync?utm_source=github.com&amp;amp;utm_medium=referral&amp;amp;utm_content=Skycoder42/QtDataSync&amp;amp;utm_campaign=Badge_Grade)</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;[![AUR](https://img.shields.io/aur/version/qt5-datasync.svg)](https://aur.archlinux.org/packages/qt5-datasync/)</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;![Demo Animation](./doc/images/demo.gif)</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;# Features {#qtdatasync_readme_label_0}</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;- Document-Store like access, using QObjects and Q_GADGET classes</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;   - Threadsafe synchronous access with global caching optimizations</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;   - Change signals on data modifications</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;- Cross platform library, works on linux, windows, macos, android and ios and can be used to synchronize data between any of these platforms</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;- Qt &quot;model&quot; class (`QAbstractListModel`) to view store data in item views</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;- Permanent offline storage, to make shure apps work even without network</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;- Remote synchronisation between devices</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;   - Multi-user and multi-device system - data is synchronized per user on all his devices</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;   - Data is stored permanently on devices, and temporarily on the server</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;   - Data is end to end encrypted</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;- Private keys are stored in secure keystores</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;   - Uses system keystore where possible. Currently supported:</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;       - KWallet</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;       - Freedesktop Secret Service API (i.e. gnome-keyring)</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;       - macOs/iOs Keychain</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;       - Windows credentials store</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;       - Android Shared Preferences</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;       - (Unsecure) plain text keystore as fallback</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   - Custom keystores can be implemented via a plugin mechanism</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;- Includes a server application as a backend</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   - Can be used for multiple applications, independent of any data</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;   - Operates as &quot;distribution&quot; service (Does *not* permanently store data, only for transfering it to devices)</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;   - Operates with a PostgreSQL database</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;   - Includes a docker-compose file for the postgresql server</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;   - Is provided as docker image itself</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;- Controller classes to control and monitor the sync state and the account</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   - Can be used in any thread</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;- Class to exchange user identities between devices in a local network</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;- Supports multi process mode (access and control data and engine from any process, with some restrictions)</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;- Provides convenient QML bindings</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;# Download/Installation {#qtdatasync_readme_label_1}</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;1. Package Managers: The library is available via:</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;   - **Arch-Linux:** AUR-Repository: [`qt5-datasync`](https://aur.archlinux.org/packages/qt5-datasync/)</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   - **Ubuntu:** Launchpad-PPA:</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;       - Since Artful: [ppa:skycoder42/qt-modules](https://launchpad.net/~skycoder42/+archive/ubuntu/qt-modules), package `libqt5datasync[4/-dev]`</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;       - Xenial: [ppa:skycoder42/qt-modules-opt](https://launchpad.net/~skycoder42/+archive/ubuntu/qt-modules-opt), package `qtdatasync`</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   - **MacOs:**</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;       - Tap: [`brew tap Skycoder42/qt-modules`](https://github.com/Skycoder42/homebrew-qt-modules)</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;       - Package: `qtdatasync`</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;       - **IMPORTANT:** Due to limitations of homebrew, you must run `source /usr/local/opt/qtdatasync/bashrc.sh` before you can use the module. Some goes for the `qtjsonserializer` dependency.</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;2. Simply add my repository to your Qt MaintenanceTool (Image-based How-To here: [Add custom repository](https://github.com/Skycoder42/QtModules/blob/master/README.md#add-my-repositories-to-qt-maintenancetool)):</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   1. Open the MaintenanceTool, located in your Qt install directory (e.g. `~/Qt/MaintenanceTool`)</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   2. Select `Add or remove components` and click on the `Settings` button</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   3. Go to `Repositories`, scroll to the bottom, select `User defined repositories` and press `Add`</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;   4. In the right column (selected by default), type:</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;       - On Linux: https://install.skycoder42.de/qtmodules/linux_x64</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;       - On Windows: https://install.skycoder42.de/qtmodules/windows_x86</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;       - On Mac: https://install.skycoder42.de/qtmodules/mac_x64</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   5. Press `Ok`, make shure `Add or remove components` is still selected, and continue the install (`Next &gt;`)</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;   6. A new entry appears under all supported Qt Versions (e.g. `Qt &gt; Qt 5.8 &gt; Skycoder42 Qt modules`)</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   7. You can install either all of my modules, or select the one you need: `Qt Data Sync`</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;   8. Continue the setup and thats it! you can now use the module for all of your installed Kits for that Qt Version</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;3. Download the compiled modules from the release page. **Note:** You will have to add the correct ones yourself and may need to adjust some paths to fit your installation! In addition to that, you will have to download the modules this one depends on as well. See Section &quot;Requirements&quot; below.</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;4. Build it yourself! **Note:** This requires all build an runtime dependencies to be available (See Section &quot;Requirements&quot; below). If you don&#39;t have/need cmake, you can ignore the related warnings. To automatically build and install to your Qt installation, run:</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   - `qmake`</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   - `make qmake_all`</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   - `make` (If you want the tests/examples/etc. run `make all`)</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   - Optional steps:</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;       - `make doxygen` to generate the documentation</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;       - `make lrelease` to generate the translations</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   - `make install`</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;# Requirements {#qtdatasync_readme_label_2}</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;The library as a high level synchronisation backend has a few dependencies. They are listed below by categories. When installing via a package manager or with Qt Maintenancetool (prefered methods, see section &quot;Download/Installation&quot;&quot; above) all these dependencies will be installed automatically.</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;- Official Qt Modules:</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   - QtCore (qtbase)</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   - QtSql (qtbase) with the qsqlite plugin</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   - QtWebSockets</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;   - QtScxml</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   - QtRemoteObjects (currently a TP module)</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;- Custom Qt modules:</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   - [QJsonSerializer](https://github.com/Skycoder42/QJsonSerializer)</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;- Additional stuff for building it yourself:</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   - perl</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;   - [CryptoPP library](https://www.cryptopp.com/) (Can also be linked dynamically)</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   - [qpmx](https://github.com/Skycoder42/qpmx)</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;   - [qpm](https://github.com/Cutehacks/qpm)</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   - Some of the plugins also have additional dependencies:</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;       - kwallet: [KWallet Framework](https://api.kde.org/frameworks/kwallet/html/)</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;       - secretservice: libsecret-1 via pkgconfig</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   - For the appserver:</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;       - qpsql plugin for the QtSql module</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;To actually run the server, it needs to connect to a SQL Database. A little more specific: A PostgreSQL database. You can specify a different one, by setting a custom database driver in the configuration file, **but** the SQL used is PostgreSQL, so unless your DBS supports the same SQL flavor, you won&#39;t be able to get it running without modifications. You can host a PostgreSQL database using docker by running `docker-compose up -d` from `tools/qdatasyncserver`. This is further described in the example explaining how to set up the server.</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;## Docker {#qtdatasync_readme_label_3}</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;The `qdsapp` is also available as docker-image, [`skycoder42/qdsapp`](https://hub.docker.com/r/skycoder42/qdsapp/). The versions are equal, i.e. QtDataSync version 4.0.0 will work with the server Version 4.0.0 as well. The server is somewhat backwards compatible. This is checked on runtime for any client that connects.</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;# Usage {#qtdatasync_readme_label_4}</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;The datasync library is provided as a Qt module. Thus, all you have to do is add the module, and then, in your project, add `QT += datasync` to your `.pro` file! Please note that when you deploy your application, you need both the library *and* the keystore plugins you intend to use.</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;## Basics {#qtdatasync_readme_label_5}</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;There are basically 3 kinds of classes typically used. This first one is the `QtDataSync::Setup`. This one is used to configure a datasync instance and synchronize data to a server. It can also be used to start a passive instance, that does not actively synchronize and only allows access to the data.</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;The second group are the `QtDataSync::DataStore*` classes. They are used to access the data and perform CRUD operations on it. They only work with the locally stored data, but emit signals whenever data is changed (either by another datastore, or because it was synchronized). The `QtDataSync::DataStore` is the basic class that allows you to generically access any data. The `QtDataSync::DataTypeStore` does the same, but is limited to one type. Finally, the `QtDataSync::CachingDataTypeStore` extend this by initially loading all data of one type and keeping it in the memory. This can be more efficient if our frequently access the data.</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;The last group are the manager classes. The `QtDataSync::SyncManager` controlls the synchronisation and reports it&#39;s status, progress and any errors. The `QtDataSync::AccountManager` is used to manage the devices data is shared with. They can be listed, added and removed. The `QtDataSync::UserExchangeManager` extends the AccountManager by making it possible to easily exchange the account data between devices in the same local network.</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;The examples below show how to use these different classes. For a full example of what can be done, checkout the `examples/datasync/Sample` example app.</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;## Example {#qtdatasync_readme_label_6}</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;The following examples descibe the different parts of the module, and how to use them. The following will explain how to:</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;- Create a setup and configure it.</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;- Access the storage for read/write operations</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;- Setup a server to synchronize with it</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;- Add a second device to your account to synchronize data between them</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;### Initialize QtDataSync {#qtdatasync_readme_label_7}</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;After adding datasync to your project, the next step is to setup datasync. In your main, you need to once create a setup. This **must** be done before you create any other datasync class, but after that, you can use it in your whole application from any thread. Multi-Process setups are possible, but more complicated. See documentation for more details.</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;To setup datasync, simply use the Setup class:</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;```cpp</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;QtDataSync::Setup()</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   .setRemoteConfiguration(QUrl(&quot;ws://localhost:4242&quot;)) //url to the server to connect to</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;   //do any additional setup, i.e. &quot;.setLocalDir(...)&quot; to specify a different local storage directory</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;   .create();</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;```</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;And thats it! On a second thread, the storage will be initialized. You can now use the different stores or the managers to access the data.</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;### Using DataStore {#qtdatasync_readme_label_8}</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;The data store allows you to access the store. The store can be used by defining datatypes that can be stored in there. The only limitation is that it must be either a class that extends QObject or has the Q_GADGET macro. Only the Q_PROPERTY fields you define are stored. To identify a dataset the `USER` property is used and thus **must** be present. It&#39;s like the primary key. You can use any type you want, as long as it can be converted from and to QString via QVariant (This means `QVariant::fromType(myData).toString()`, as well as `QVariant(string).value&lt;MyData&gt;()` have to work as expected).</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;One example for such a storable datatype would be the following:</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;```cpp</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;struct Data</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;{</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   Q_GADGET</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;   Q_PROPERTY(int key MEMBER int USER true)</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;   Q_PROPERTY(QString value MEMBER value)</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;public:</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   Post();</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   int key;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;   QString value;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;};</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;```</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;This can now be stored and loaded using any of the DataStore classes. The code below will save on dataset, then load all that are stored:</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;```cpp</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;auto store = new QtDataSync::DataStore(this); //Use the &quot;default setup&quot;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;//store an entry</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;store-&gt;save&lt;Data&gt;({42, &quot;tree&quot;});</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;//load all entries</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;for(Data d : store-&gt;loadAll&lt;Data&gt;()) {</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   qDebug() &lt;&lt; d.key &lt;&lt; d.value;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;});</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;```</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;### Setting up the remote server (qdsapp) {#qtdatasync_readme_label_9}</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;In order to synchronize data, some server is needed. The quickest way for development is to use the prepared docker image in the sample projects folder. Just run `docker-compose up -d` to start it. It will create a postgres as well as a qdsapp instance to be used on port 4242. More details on how to configure the the server can be found in the documentation.</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;Once thats done, the library will automatically connect to the server and create an account, if the server was correctly configured with the setup. To synchronize changes, all you need to do now is to add a second device to your account.</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;### Adding a second device to your account {#qtdatasync_readme_label_10}</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;Adding a second devices is done via an exchange between those two devices. This is required to ensure no attacker can easily add himself to your account. The general idea is: You export the data from device A, then import it on device B. The part of getting the data from A to B must be done by your application, e.g. by storing it to a file or sending it over the local network. A must then accept B to be added to the account. It is also possible to secure the exported data with a password. In that case no confirmation is needed. Please note that device A must be connected to the remote for the whole login process. After device B was added, A will upload all it&#39;s local data to B. From that point on, any data changes on A or B are synchronized between the two.</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;The first partis to export the data from A. For this example, we use the password secured variant, as it is simpler.</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;```cpp</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;auto manager = new QtDataSync::AccountManager(this); //class used to access the account</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;manager-&gt;exportAccountTrusted(true, &quot;some_password&quot;, [this](QByteArray data) {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   saveToFile(data);//somehow get the data to device B</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;});</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;```</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;On device B, that exported data must be read and then imported:</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;```cpp</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;auto manager = new QtDataSync::AccountManager(this); //class used to access the account</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;auto data = loadFromFile();</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;manager-&gt;importAccountTrusted(data, &quot;some_password&quot;, [this](bool ok, QString error) {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   if(ok)</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;       qDebug() &lt;&lt; &quot;Import done!&quot;;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;   else</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;       qDebug() &lt;&lt; &quot;Import failed with error:&quot; &lt;&lt; error;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;});</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;```</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;If the import succeeded, the devices will automatically start synchronizing</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;# Security {#qtdatasync_readme_label_11}</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;The library uses end to end encryption and does not require a trusted server, as the server can neither read or write data, nor can he add a device to your account. Modern and secure crypto is used by making use of the [CryptoPP library](https://www.cryptopp.com/) library. More details on the whole (security) protocol will follow in the future.</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;# Documentation {#qtdatasync_readme_label_12}</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;The documentation is available on [github pages](https://skycoder42.github.io/QtDataSync/). It was created using [doxygen](http://www.doxygen.org/). The HTML-documentation and Qt-Help files are shipped together with the module for both the custom repository and the package on the release page. Please note that doxygen docs do not perfectly integrate with QtCreator/QtAssistant.</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;# References {#qtdatasync_readme_label_13}</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;Many of the keystore implementations have been inspired by the awesome Qt library [QtKeychain](https://github.com/frankosterfeld/qtkeychain) by frankosterfeld.</div></div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Feb 18 2018 15:02:44 for QtDataSync by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
